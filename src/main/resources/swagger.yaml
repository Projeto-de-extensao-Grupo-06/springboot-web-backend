openapi: 3.0.3
info:
  title: Solarize Web Backend API
  description: API para gerenciamento de projetos solares, clientes, orçamentos e agendamentos.
  version: 1.0.0
servers:
  - url: http://localhost:8080
    description: Servidor Local
components:
  securitySchemes:
    cookieAuth:
      type: apiKey
      in: cookie
      name: Authorization
  schemas:
    # --- Address Schemas ---
    CreateAddressDto:
      type: object
      required:
        - postalCode
        - streetName
        - neighborhood
        - city
        - state
        - type
      properties:
        postalCode:
          type: string
          description: CEP
        streetName:
          type: string
          description: Nome da rua
        number:
          type: string
          description: Número
        neighborhood:
          type: string
          description: Bairro
        city:
          type: string
          description: Cidade
        state:
          type: string
          enum: [AC, AL, AP, AM, BA, CE, DF, ES, GO, MA, MT, MS, MG, PA, PB, PR, PE, PI, RJ, RN, RS, RO, RR, SC, SP, SE, TO]
          description: Estado (UF)
        type:
          type: string
          enum: [COMMERCIAL, RESIDENTIAL]
          description: Tipo de endereço
        apartment:
          type: string
          description: Complemento/Apartamento

    UpdateAddressDto:
      type: object
      properties:
        postalCode:
          type: string
        streetName:
          type: string
        number:
          type: string
        neighborhood:
          type: string
        city:
          type: string
        state:
          type: string
          enum: [AC, AL, AP, AM, BA, CE, DF, ES, GO, MA, MT, MS, MG, PA, PB, PR, PE, PI, RJ, RN, RS, RO, RR, SC, SP, SE, TO]
        type:
          type: string
          enum: [COMMERCIAL, RESIDENTIAL]
        apartment:
          type: string

    ResponseAddressDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        postalCode:
          type: string
        streetName:
          type: string
        number:
          type: string
        neighborhood:
          type: string
        city:
          type: string
        uf:
          type: string
        stateName:
          type: string
        type:
          type: string
        apartment:
          type: string

    # --- Auth Schemas ---
    CoworkerCredentialsDto:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
        password:
          type: string
          format: password

    AuthResponseDto:
      type: object
      properties:
        userId:
          type: integer
          format: int64
        firstName:
          type: string
        lastName:
          type: string
        token:
          type: string
        authorities:
          type: array
          items:
            type: object
            description: GrantedAuthority object

    RecoveryPasswordDto:
      type: object
      properties:
        email:
          type: string
          format: email

    RecoveryPasswordOtpDto:
      type: object
      required:
        - otp
      properties:
        otp:
          type: string
        email:
          type: string
          format: email

    ChangePasswordDto:
      type: object
      properties:
        password:
          type: string
          pattern: '^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[@#$%^&+=!?.*_-]).{8,}$'

    # --- Budget Schemas ---
    BudgetManualCreateDto:
      type: object
      properties:
        discount:
          type: number
          format: double
          default: 0.0
        discountType:
          type: string
          enum: [PERCENT, VALUE]
          default: PERCENT
        finalBudget:
          type: boolean
          default: false
        materials:
          type: array
          items:
            $ref: '#/components/schemas/BudgetMaterialCreateDto'
        fixedParameters:
          type: array
          items:
            $ref: '#/components/schemas/FixedParameterCreateDto'
        personalizedParameters:
          type: array
          items:
            $ref: '#/components/schemas/PersonalizedParameterDto'

    BudgetMaterialCreateDto:
      type: object
      required:
        - materialId
        - quantity
      properties:
        materialId:
          type: integer
          format: int64
        quantity:
          type: integer

    PersonalizedParameterDto:
      type: object
      required:
        - name
        - type
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        type:
          type: string
          enum: [PERCENT, VALUE]
        value:
          type: number
          format: double

    FixedParameterCreateDto:
      type: object
      required:
        - parameterName
        - value
      properties:
        parameterName:
          type: string
          description: Enum FixedParameterName (ex. ART, DISPLACEMENT_COST, etc.)
        value:
          type: number
          format: double

    BudgetPatchDto:
      type: object
      properties:
        discount:
          type: number
          format: double
        discountType:
          type: string
          enum: [PERCENT, VALUE]
        finalBudget:
          type: boolean

    UpdateMaterialDto:
      type: object
      required:
        - materials
      properties:
        materials:
          type: array
          items:
            type: object
            required:
              - materialId
              - quantity
            properties:
              materialId:
                type: integer
                format: int64
              quantity:
                type: integer

    UpdateFixedParametersDto:
      type: object
      properties:
        fixedParameters:
          type: array
          items:
            $ref: '#/components/schemas/FixedParameterCreateDto'

    UpdatePersonalizedParametersDto:
      type: object
      required:
        - personalizedParameters
      properties:
        personalizedParameters:
          type: array
          items:
            $ref: '#/components/schemas/PersonalizedParameterDto'

    BudgetResponseDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        totalCost:
          type: number
          format: double
        subtotal:
          type: number
          format: double
        discount:
          type: number
          format: double
        discountType:
          type: string
        finalBudget:
          type: boolean
        materials:
          type: array
          items:
            type: object
            properties:
              materialUrlId:
                type: integer
                format: int64
              name:
                type: string
              url:
                type: string
              unitPrice:
                type: number
                format: double
              quantity:
                type: integer
        fixedParameters:
          type: array
          items:
            type: object
            properties:
              parameterName:
                type: string
              valueType:
                type: string
              value:
                type: number
                format: double
        personalizedParameters:
          type: array
          items:
            type: object
            properties:
              id:
                type: integer
                format: int64
              name:
                type: string
              type:
                type: string
              value:
                type: number
                format: double

    # --- Client Schemas ---
    CreateClientDTO:
      type: object
      required:
        - firstName
        - lastName
        - documentNumber
        - documentType
        - email
      properties:
        firstName:
          type: string
          example: John
        lastName:
          type: string
          example: Doe
        documentNumber:
          type: string
          pattern: '\d{5,15}'
          example: "91280161060"
        documentType:
          type: string
          example: CPF
        note:
          type: string
          maxLength: 255
        phone:
          type: string
          pattern: '\+?\d{10,15}'
        email:
          type: string
          format: email
        mainAddress:
          $ref: '#/components/schemas/CreateAddressDto'

    ClientResponseDTO:
      type: object
      properties:
        id:
          type: integer
          format: int64
        firstName:
          type: string
        lastName:
          type: string
        phone:
          type: string
        email:
          type: string
        documentNumber:
          type: string
        documentType:
          type: string
        note:
          type: string
        createdAt:
          type: string
          format: date-time
        mainAddress:
          $ref: '#/components/schemas/CreateAddressDto'

    # --- Coworker Schemas ---
    CoworkerCreateDto:
      type: object
      required:
        - firstName
        - lastName
        - email
        - phone
        - password
      properties:
        firstName:
          type: string
          minLength: 3
          maxLength: 20
          pattern: '^[a-zA-Z]+$'
        lastName:
          type: string
          minLength: 3
          maxLength: 20
          pattern: '^[a-zA-Z]+$'
        email:
          type: string
          format: email
        phone:
          type: string
          pattern: '^[1-9]{2}[9]?\d{8}$'
        password:
          type: string
          format: password
          pattern: '^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z\d])[\S]{8,}$'

    CoworkerUpdateDto:
      type: object
      required:
        - firstName
        - lastName
        - email
        - phone
      properties:
        firstName:
          type: string
          minLength: 3
          maxLength: 20
        lastName:
          type: string
          minLength: 3
          maxLength: 20
        email:
          type: string
          format: email
        phone:
          type: string

    CoworkerResponseDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        firstName:
          type: string
        lastName:
          type: string
        email:
          type: string
        phone:
          type: string

    # --- Material Schemas ---
    MaterialRequestDto:
      type: object
      required:
        - name
        - metric
      properties:
        name:
          type: string
        description:
          type: string
        metric:
          type: string
          enum: [METER, UNIT, KILO, LITERS]

    MaterialResponseDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        description:
          type: string
        metric:
          type: string

    # --- MaterialUrl Schemas ---
    MaterialUrlRequestDto:
      type: object
      properties:
        url:
          type: string
        price:
          type: number
          format: double
        materialId:
          type: integer
          format: int64

    MaterialUrlResponseDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        url:
          type: string
        price:
          type: number
          format: double

    # --- PermissionGroup Schemas ---
    PermissionGroupDto:
      type: object
      required:
        - role
        - mainModule
        - permissions
      properties:
        role:
          type: string
        mainModule:
          type: string
        permissions:
          type: array
          items:
            $ref: '#/components/schemas/ModulePermissionsDto'

    GetPermissionGroupDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        role:
          type: string
        mainModule:
          type: string
        permissions:
          type: array
          items:
            $ref: '#/components/schemas/ModulePermissionsDto'

    ModulePermissionsDto:
      type: object
      properties:
        moduleName:
          type: string
        read:
          type: boolean
        write:
          type: boolean
        update:
          type: boolean
        delete:
          type: boolean

    # --- Project Schemas ---
    ProjectManualCreateDto:
      type: object
      required:
        - name
        - clientId
        - projectType
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 60
        clientId:
          type: integer
          format: int64
        description:
          type: string
          maxLength: 1000
        addressId:
          type: integer
          format: int64
        projectType:
          type: string
          enum: [ON_GRID, OFF_GRID, HYBRID]

    ProjectUpdateDto:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 60
        clientId:
          type: integer
          format: int64
        description:
          type: string
          maxLength: 1000
        projectType:
          type: string
          enum: [ON_GRID, OFF_GRID, HYBRID]

    ProjectDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        description:
          type: string
        status:
          type: string
        previewStatus:
          type: string
        isActive:
          type: boolean
        clientId:
          type: integer
          format: int64
        coworkerId:
          type: integer
          format: int64
        addressId:
          type: integer
          format: int64
        createdAt:
          type: string
          format: date-time
        systemType:
          type: string
        projectFrom:
          type: string

    ProjectSummaryDTO:
      type: object
      properties:
        id:
          type: integer
          format: int64
        projectTitle:
          type: string
        status:
          type: string
        nextSchedule:
          type: string
          format: date-time
        responsible:
          $ref: '#/components/schemas/CoworkerResponseDto'
        client:
          $ref: '#/components/schemas/ClientResponseDTO'
        commentCount:
          type: integer
        fileCount:
          type: integer

    # --- ProjectFile Schemas ---
    ProjectFileResponseDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        originalFilename:
          type: string
        contentType:
          type: string
        mbSize:
          type: integer
        homologationDoc:
          type: boolean
        filename:
          type: string
        checkSum:
          type: string
        createdAt:
          type: string
          format: date-time
        uploader:
          $ref: '#/components/schemas/CoworkerResponseDto'

    ProjectFileGetResponseDto:
      type: object
      properties:
        id:
          type: integer
          format: int64
        originalFilename:
          type: string
        mbSize:
          type: integer
        homologationDoc:
          type: boolean
        createdAt:
          type: string
          format: date-time
        uploader:
          $ref: '#/components/schemas/CoworkerResponseDto'

    # --- Schedule Schemas ---
    CreateScheduleDTO:
      type: object
      required:
        - title
        - startDate
        - type
      properties:
        title:
          type: string
        description:
          type: string
        startDate:
          type: string
          format: date-time
        endDate:
          type: string
          format: date-time
        type:
          type: string
          enum: [VISIT, INSTALLATION, MAINTENANCE, OTHER]
        coworkerId:
          type: integer
          format: int64
        projectId:
          type: integer
          format: int64

    ScheduleResponseDTO:
      type: object
      properties:
        id:
          type: integer
          format: int64
        title:
          type: string
        description:
          type: string
        startDate:
          type: string
          format: date-time
        endDate:
          type: string
          format: date-time
        notificationDate:
          type: string
          format: date-time
        type:
          type: string
        status:
          type: string
        isActive:
          type: boolean
        projectId:
          type: integer
          format: int64
        coworkerId:
          type: integer
          format: int64

    # --- Common ---
    PageProjectSummaryDTO:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/ProjectSummaryDTO'
        totalPages:
          type: integer
        totalElements:
          type: integer
          format: int64
        size:
          type: integer
        number:
          type: integer
        numberOfElements:
          type: integer
        empty:
          type: boolean

security:
  - cookieAuth: []

paths:
  # --- Address Controller ---
  /address:
    post:
      tags: [Address]
      summary: Criar novo endereço
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAddressDto'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseAddressDto'

  /address/{addressId}:
    get:
      tags: [Address]
      summary: Buscar endereço por ID
      parameters:
        - name: addressId
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseAddressDto'
    patch:
      tags: [Address]
      summary: Atualizar endereço
      parameters:
        - name: addressId
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateAddressDto'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseAddressDto'

  # --- Auth Controller ---
  /auth/login:
    post:
      tags: [Auth]
      summary: Realizar Login (Retorna Cookies)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CoworkerCredentialsDto'
      responses:
        '204':
          description: No Content (Login realizado com sucesso)
          headers:
            Set-Cookie:
              schema:
                type: string
                description: Authorization, userFirstName, userLastName, userAuthorities

  /auth/logout:
    post:
      tags: [Auth]
      summary: Realizar Logout
      responses:
        '204':
          description: No Content (Cookies removidos)

  /auth/forget-password:
    post:
      tags: [Auth]
      summary: Solicitar código de recuperação de senha
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RecoveryPasswordDto'
      responses:
        '204':
          description: No Content (Código enviado)

  /auth/confirm-otp:
    post:
      tags: [Auth]
      summary: Confirmar código OTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RecoveryPasswordOtpDto'
      responses:
        '204':
          description: No Content (Token de reset definido no cookie)

  /auth/change-password/token:
    patch:
      tags: [Auth]
      summary: Alterar senha usando token (cookie)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChangePasswordDto'
      responses:
        '204':
          description: No Content (Senha alterada)

  # --- Budget Controller ---
  /projects/{projectId}/budget:
    post:
      tags: [Budget]
      summary: Criar orçamento manual
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BudgetManualCreateDto'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BudgetResponseDto'
    patch:
      tags: [Budget]
      summary: Atualizar orçamento (Desconto/Tipo/Final)
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BudgetPatchDto'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BudgetResponseDto'
    get:
      tags: [Budget]
      summary: Buscar orçamento do projeto
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BudgetResponseDto'

  /projects/{projectId}/budget/material:
    patch:
      tags: [Budget]
      summary: Atualizar materiais do orçamento
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateMaterialDto'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BudgetResponseDto'

  /projects/{projectId}/budget/parameters/fixed:
    patch:
      tags: [Budget]
      summary: Atualizar parâmetros fixos
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateFixedParametersDto'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BudgetResponseDto'

  /projects/{projectId}/budget/parameters/personalized:
    patch:
      tags: [Budget]
      summary: Atualizar parâmetros personalizados
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdatePersonalizedParametersDto'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BudgetResponseDto'

  /budgets/{budgetId}/materials/{materialId}:
    delete:
      tags: [Budget]
      summary: Remover material do orçamento
      parameters:
        - name: budgetId
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: materialId
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BudgetResponseDto'

  /budgets/{budgetId}/parameters/fixed/{parameterName}:
    delete:
      tags: [Budget]
      summary: Remover parâmetro fixo do orçamento
      parameters:
        - name: budgetId
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: parameterName
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BudgetResponseDto'

  /budgets/{budgetId}/parameters/personalized/{parameterId}:
    delete:
      tags: [Budget]
      summary: Remover parâmetro personalizado do orçamento
      parameters:
        - name: budgetId
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: parameterId
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BudgetResponseDto'

  # --- Client Controller ---
  /clients:
    get:
      tags: [Client]
      summary: Listar clientes
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ClientResponseDTO'
        '204':
          description: No Content
    post:
      tags: [Client]
      summary: Criar cliente
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateClientDTO'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClientResponseDTO'

  /clients/{id}:
    get:
      tags: [Client]
      summary: Buscar cliente por ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClientResponseDTO'
    put:
      tags: [Client]
      summary: Atualizar cliente
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateClientDTO'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ClientResponseDTO'
    delete:
      tags: [Client]
      summary: Deletar cliente
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: No Content

  # --- Coworker Controller ---
  /coworkers:
    get:
      tags: [Coworker]
      summary: Listar colaboradores
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CoworkerResponseDto'
        '204':
          description: No Content
    post:
      tags: [Coworker]
      summary: Criar colaborador
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CoworkerCreateDto'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CoworkerResponseDto'

  /coworkers/{id}:
    get:
      tags: [Coworker]
      summary: Buscar colaborador por ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CoworkerResponseDto'
    put:
      tags: [Coworker]
      summary: Atualizar colaborador
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CoworkerUpdateDto'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CoworkerResponseDto'
    delete:
      tags: [Coworker]
      summary: Deletar colaborador
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: No Content

  # --- Material Controller ---
  /materials:
    get:
      tags: [Material]
      summary: Listar materiais
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MaterialResponseDto'
        '204':
          description: No Content
    post:
      tags: [Material]
      summary: Criar material
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MaterialRequestDto'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MaterialResponseDto'

  /materials/{id}:
    get:
      tags: [Material]
      summary: Buscar material por ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MaterialResponseDto'
    put:
      tags: [Material]
      summary: Atualizar material
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MaterialRequestDto'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MaterialResponseDto'
    delete:
      tags: [Material]
      summary: Deletar material
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: No Content

  # --- MaterialUrl Controller ---
  /materialUrls:
    post:
      tags: [MaterialUrl]
      summary: Criar URL de material
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MaterialUrlRequestDto'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MaterialUrlResponseDto'

  /materialUrls/{id}:
    get:
      tags: [MaterialUrl]
      summary: Buscar URL de material por ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MaterialUrlResponseDto'
    put:
      tags: [MaterialUrl]
      summary: Atualizar URL de material
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MaterialUrlRequestDto'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MaterialUrlResponseDto'
    delete:
      tags: [MaterialUrl]
      summary: Deletar URL de material
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: No Content

  /materialUrls/material/{materialId}:
    get:
      tags: [MaterialUrl]
      summary: Listar URLs por ID do material
      parameters:
        - name: materialId
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MaterialUrlResponseDto'
        '204':
          description: No Content

  # --- PermissionGroup Controller ---
  /permission-groups:
    post:
      tags: [PermissionGroup]
      summary: Criar grupo de permissões
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PermissionGroupDto'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetPermissionGroupDto'

  /permission-groups/{id}:
    get:
      tags: [PermissionGroup]
      summary: Buscar grupo de permissões por ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetPermissionGroupDto'

  # --- Project Controller ---
  /projects:
    get:
      tags: [Project]
      summary: Listar projetos (com paginação e filtros)
      parameters:
        - name: search
          in: query
          required: false
          schema:
            type: string
        - name: status
          in: query
          required: false
          schema:
            type: array
            items:
              type: string
              enum: [NEW, PRE_BUDGET, ...]
        - name: responsibleId
          in: query
          required: false
          schema:
            type: integer
            format: int64
        - name: clientId
          in: query
          required: false
          schema:
            type: integer
            format: int64
        - name: page
          in: query
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PageProjectSummaryDTO'

  /projects/manual:
    post:
      tags: [Project]
      summary: Criar projeto manualmente
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProjectManualCreateDto'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectDto'

  /projects/{projectId}:
    get:
      tags: [Project]
      summary: Buscar projeto por ID
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectDto'
    patch:
      tags: [Project]
      summary: Atualizar projeto
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProjectUpdateDto'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProjectDto'
    delete:
      tags: [Project]
      summary: Deletar (soft delete) projeto
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: No Content

  # --- ProjectFile Controller ---
  /projects/{projectId}/files:
    get:
      tags: [ProjectFile]
      summary: Listar arquivos do projeto
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProjectFileGetResponseDto'
        '204':
          description: No Content
    post:
      tags: [ProjectFile]
      summary: Upload de arquivos para o projeto
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: isHomologation
          in: query
          required: true
          schema:
            type: boolean
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                files:
                  type: array
                  items:
                    type: string
                    format: binary
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProjectFileResponseDto'

  /projects/{projectId}/files/{fileId}/download:
    get:
      tags: [ProjectFile]
      summary: Download de arquivo
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: fileId
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary

  # --- Schedule Controller ---
  /schedules:
    get:
      tags: [Schedule]
      summary: Listar agendamentos (filtro por mês/ano)
      parameters:
        - name: year
          in: query
          schema:
            type: integer
        - name: month
          in: query
          schema:
            type: integer
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ScheduleResponseDTO'
        '204':
          description: No Content
    post:
      tags: [Schedule]
      summary: Criar agendamento
      parameters:
        - name: force
          in: query
          schema:
            type: boolean
            default: false
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateScheduleDTO'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScheduleResponseDTO'

  /schedules/{id}:
    get:
      tags: [Schedule]
      summary: Buscar agendamento por ID
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScheduleResponseDTO'
    patch:
      tags: [Schedule]
      summary: Atualizar agendamento
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
        - name: force
          in: query
          schema:
            type: boolean
            default: false
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateScheduleDTO'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScheduleResponseDTO'
    delete:
      tags: [Schedule]
      summary: Deletar agendamento
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: No Content